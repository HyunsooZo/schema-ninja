<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Schema Ninja</title>
  <link rel="stylesheet" href="css/style.css" />

  <meta property="og:type" content="website">
  <meta property="og:url" content="https://schema-ninja-nine.vercel.app/">
  <meta property="og:title" content="Schema Ninja">
  <meta property="og:description" content="Visualize your SQL DDL instantly.">
  <meta property="og:image" content="https://schema-ninja-nine.vercel.app/images/preview-logo.jpeg">

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Schema Ninja">
  <meta name="twitter:description" content="Visualize your SQL DDL instantly.">
  <meta name="twitter:image" content="https://schema-ninja-nine.vercel.app/images/preview-logo.jpeg">
</head>

<body data-theme="dark">
  <header>
    <div class="brand-wrapper">
      <h1>
        <img src="images/logo.jpg" alt="Schema Ninja Logo" class="app-logo" />
        Schema Ninja
      </h1>
      <span class="app-tagline">Visualize your SQL DDL instantly.</span>
    </div>

    <button class="theme-toggle" onclick="toggleTheme()">Light Mode</button>
  </header>

  <main>
    <div class="editor-container">
      <div class="toolbar">
        <button class="action-btn" onclick="window.visualize()">
          Visualize
        </button>
        <button class="action-btn" style="background: #555" onclick="window.formatSQL()">
          Prettify
        </button>
        <button class="action-btn" style="background: #10b981" onclick="window.exportPNG()">
          Export PNG
        </button>
        <button class="action-btn" style="background: #8b5cf6"
          onclick="document.getElementById('rel-modal').showModal(); window.populateTableSelects()">
          Relationship +
        </button>
      </div>

      <!-- Relationship Helper Modal -->
      <dialog id="rel-modal" class="modal">
        <div class="modal-content">
          <h3>Add Relationship</h3>
          <div class="form-group">
            <label>Source Table</label>
            <select id="rel-source"></select>
          </div>
          <div class="form-group">
            <label>Type</label>
            <select id="rel-type">
              <option value="||--||">1 : 1 (One to One)</option>
              <option value="||--|{">1 : N (One to Many)</option>
              <option value="}|--||">N : 1 (Many to One)</option>
              <option value="}|--|{">N : M (Many to Many)</option>
            </select>
          </div>
          <div class="form-group">
            <label>Target Table</label>
            <select id="rel-target"></select>
          </div>
          <div class="form-group">
            <label>Label (Optional)</label>
            <input type="text" id="rel-label" placeholder="e.g. owns, has..." />
          </div>
          <div class="modal-actions">
            <button onclick="document.getElementById('rel-modal').close()">Cancel</button>
            <button class="primary" onclick="window.addRelationship()">Add</button>
          </div>
        </div>
      </dialog>

      <div class="editor-wrapper">
        <pre id="highlight-layer" class="code-highlight code-font-style"></pre>
        <textarea id="sql-input" class="code-input code-font-style" spellcheck="false" oninput="handleInput(this)"
          onscroll="syncScroll(this)">
CREATE TABLE Users (
    user_id INT PRIMARY KEY,
    username VARCHAR(50) NOT NULL
);

CREATE TABLE Orders (
    order_id INT PRIMARY KEY,
    user_id INT NOT NULL,
    product_name VARCHAR(100),
    FOREIGN KEY (user_id) REFERENCES Users(user_id)
);

CREATE TABLE OptionalItems (
    item_id INT PRIMARY KEY,
    order_id INT,
    price DECIMAL(10,2),
    FOREIGN KEY (order_id) REFERENCES Orders(order_id)
);
            </textarea>
      </div>
    </div>

    <div class="resizer" id="resizer"></div>

    <div class="preview-container">
      <div id="mermaid-output"></div>

      <div class="zoom-controls">
        <button id="btn-zoom-in" title="Zoom In">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
            stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="11" cy="11" r="8"></circle>
            <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
            <line x1="11" y1="8" x2="11" y2="14"></line>
            <line x1="8" y1="11" x2="14" y2="11"></line>
          </svg>
        </button>
        <button id="btn-zoom-out" title="Zoom Out">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
            stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="11" cy="11" r="8"></circle>
            <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
            <line x1="8" y1="11" x2="14" y2="11"></line>
          </svg>
        </button>
        <button id="btn-reset" title="Fit to Screen">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
            stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="12" cy="12" r="3"></circle>
            <path d="M12 2v3m0 14v3"></path>
            <path d="M2 12h3m14 0h3"></path>
            <path d="M5 5h-2v2"></path>
            <path d="M19 5h2v2"></path>
            <path d="M5 19h-2v-2"></path>
            <path d="M19 19h2v-2"></path>
          </svg>
        </button>
      </div>
    </div>
  </main>

  <script src="https://cdn.jsdelivr.net/npm/svg-pan-zoom@3.6.1/dist/svg-pan-zoom.min.js"></script>
  <script type="module" src="js/script.js"></script>
</body>

</html>